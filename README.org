# -*- coding: utf-8; -*-

 *大部分源码由 ChatGPT-4 模型生成*, [[file:./dict-line.org][提问过程]]

站在巨人肩膀上模仿的 Emeacs show Dict on modeline Package.

参考: [[https://github.com/program-in-chinese/vscode_english_chinese_dictionary][GitHub - program-in-chinese/vscode_english_chinese_dictionary: vscode插件, 实现离线...]]

使用 Emacs modeline 中查看 字典, 帮助你了解更多语言.

* Preview
图:

[[./preview.png]]

视频:

[[./preview.gif]]

* 支持的字典列表
- 下载字典: [[https://github.com/program-in-chinese/vscode_english_chinese_dictionary/tree/master/src/%E8%AF%8D%E5%85%B8%E6%95%B0%E6%8D%AE][vscode_english_chinese_dictionary/src/词典数据 at master · program-in-chinese/vsc...]]

* 配置示例
 *use-pakage*
#+begin_src emacs-lisp :tangle yes
(use-package dict-line
  :diminish
  (dict-line-mode "🗺️")
  :ensure nil
  :load-path "path-to/dict-line"
  :defer 2
  :custom
  (dict-line-dict-directory "path-to/dict")
  (dict-line-more-icon " ⚔️ ")
  (dict-line-idle-delay 1)
  :config
  (global-dict-line-mode))
#+end_src

 *其它用户*
#+begin_src emacs-lisp :tangle yes
(add-to-list 'load-path "path-to/dict-line")
(require 'dict-linel)
(setq dict-line-dict-directory "path-to/dict")
(setq dict-line-more-icon " ⚔️ ")
(setq dict-line-idle-delay 1)
;; open mode to use dict-line function.
(global-dict-line-mode t)
#+end_src
*** 播放单词音频文件
播放音频外部依赖程序: [[http://www.mplayerhq.hu/design7/dload.html][MPlayer - The Movie Player]]
音频文件: [[https://github.com/yousefvand/pronunciations/tree/809cc0ca4d6ac4dbf0519e1caa40e581d41c2df3][GitHub - yousefvand/pronunciations at 809cc0ca4d6ac4dbf0519e1caa40e581d41c2df3]]
#+begin_src emacs-lisp :tangle yes
(setq dict-line-audio-root-dir "path-to/dict/audio")
(setq dict-line-audio t)
#+end_src

* 参数
- dict-line-dict-directory
  字典文件目录, 必须的
- dict-line-idle-delay
  光标空闲多长开始查找单词,
  默认: 1 秒
- dict-line-icon
  在 modeline 显示字典的图标
- dict-line-more-icon
  不同词性图标
- dict-line-no-results-string
  字典文件没有找到单词时 显示的内容
- dict-line-dict-extension
  字典文件扩展名类型, 用户一般不需要设置这个选项
- dict-line-audio
  播放单词音频文件 t/nil
- dict-line-audio-root-dir
  音频文件夹
- dict-line-audio-file-extension
  音频文件夹 扩展名, 默认 .mp3
- dict-line-audio-program
  音频文件播放后端程序, 默认: mplayer

* TODO List
- [  ] 异步
- [  ] 支持更多 Dict 类型
- [  ] 外部索引, 例如: ripgre, grep 等等
- [  ] 支持更多显示方式, 例如: posframe, popup, overlay
- [  ] 支持更多后端, 例如: sdcv

* 后记
解析速度蛮不错的, 感觉不到卡顿.

* 贡献
欢迎 PR.

Welcome Pull request.

* ChangLog
** V0.03
添加 音频 文件 自动播放 支持
** V0.02
修复开启 dict-line-mode 导致 modeline 显示 *invalid* 错误
** V0.01 发布
